<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.mju.ict.repository.IAnswerDAO">
	<resultMap type="com.mju.ict.model.Answer" id="answer">
		<result column="answer_id" property="answer_id" />
		<result column="question_category_id"
			property="question_category_id" />
		<result column="answer_created" property="answer_created" />
		<result column="answer_title" property="answer_title" />
		<result column="answer_content" property="answer_content" />

		<association javaType="com.mju.ict.model.QuestionCategory"
			property="questionCategory">
			<id column="question_category_id" property="question_category_id" />
			<result column="question_category_title"
				property="question_category_title" />
		</association>
	</resultMap>

	<select id="selectAllAnswers" resultMap="answer">
		SELECT * FROM tb_answer
		LEFT JOIN
		tb_question_category
		ON
		tb_answer.question_category_id =
		tb_question_category.question_category_id
	</select>


	<select id="selectFaqAnswerById" parameterType="Integer" resultMap="answer">
		SELECT * FROM tb_answer
		LEFT JOIN
		tb_question_category
		ON
		tb_answer.question_category_id =
		tb_question_category.question_category_id
		WHERE
		tb_answer.question_category_id is not null
		AND
		answer_id = #{id}
	</select>
	<insert id="insertAnswer"
		parameterType="com.mju.ict.model.Answer" useGeneratedKeys="true"
		keyProperty="answer_id">
		INSERT INTO tb_answer
		(question_category_id,answer_title,answer_content)
		VALUES(
			<choose>
			<when test="question_category_id == 0">
				NULL
			</when>
			<otherwise>
				#{question_category_id}
			</otherwise>
		</choose>
		,#{answer_title},#{answer_content})
	</insert>
	
	<delete id="deleteAnswerById" parameterType="Integer">
		DELETE FROM
		tb_answer
		WHERE
		answer_id = #{answer_id}
	</delete>
</mapper>