<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.mju.ict.repository.IProductDAO">

	<resultMap type="com.mju.ict.model.Product" id="product">
		<result column="product_id" property="product_id" />
		<result column="brand_id" property="product_id" />
		<result column="category_code" property="category_code" />
		<result column="product_created" property="product_created" />
		<result column="product_name" property="product_name" />
		<result column="product_price" property="product_price" />
		<result column="product_quantity" property="product_quantity" />
		<result column="product_desc" property="product_desc" />
		<result column="product_material" property="product_material" />
		<result column="product_volume" property="product_volume" />
		<result column="on_discount" property="on_discount" />
		<result column="on_sale" property="on_sale" />

		<association javaType="com.mju.ict.model.Brand"
			property="brand">
			<id column="brand_id" property="brand_id" />
			<result column="brand_name" property="brand_name" />
		</association>

		<association javaType="com.mju.ict.model.Category"
			property="category">
			<id column="category_code" property="category_code" />
			<result column="category_code2" property="category_code2" />
			<result column="category_name" property="category_name" />
		</association>
	</resultMap>

	<insert id="insertProduct"
		parameterType="com.mju.ict.model.Product">
		INSERT INTO tb_product
		(brand_id,category_code,product_name,product_price,
		product_quantity,product_desc,
		product_material,product_volume,
		on_discount,on_sale) 
		VALUES(
		#{brand_id},#{category_code},#{product_name},#{product_price},
		#{product_quantity},#{product_desc},#{product_material},#{product_volume},#{on_discount},#{on_sale}
		)
		
	</insert>
	
	<select id="selectProductsByCategory" parameterType="Integer"
		resultMap="product">
		SELECT * FROM tb_product
		LEFT JOIN
		tb_brand
		ON
		tb_brand.brand_id = tb_product.brand_id
		LEFT JOIN
		tb_category
		ON
		tb_category.category_code= tb_product.category_code
		WHERE
		tb_product.category_code Like CONCAT(#{category},'%','%')
	</select>

	<select id="selectProductById" parameterType="Integer"
		resultMap="product">
		SELECT * FROM tb_product
		WHERE
		product_id = #{id}
	</select>

	<select id="selectAllProducts" resultMap="product">
		SELECT * FROM tb_product
	</select>

</mapper>